"""
자연어 기반 통합 제안서

JSON 구조 강제 제거 및 순수 LLM 추론 기반 시스템으로 전환
"""

# 📋 전환 계획

## 1. 현재 문제점 해결 완료 ✅

### A. JSON 직렬화 오류 해결
- 기존: `Object of type PlanStep is not JSON serializable`
- 해결: Pydantic 모델 대신 자연어 직접 사용

### B. 에이전틱 AI 원칙 준수  
- 기존: 키워드 파싱 기반 plan_validator
- 해결: 순수 LLM 추론으로 대체

### C. 허위 성공 보고 문제 해결
- 기존: 실제 작업 없이 성공 보고
- 해결: 자연어 기반 실시간 검증

## 2. 자연어 기반 시스템 장점 🌟

### A. 더 자연스러운 추론
```
기존: JSON { "action": "tool_call", "tool": "file_create", "params": {...} }
개선: "테스트 파일을 만들기 위해 파일 생성 도구를 사용하겠습니다"
```

### B. 유연한 계획 수정
```
기존: 구조화된 단계별 계획 수정 복잡
개선: "상황이 바뀌어서 다른 방법으로 접근하겠습니다"
```

### C. 컨텍스트 이해 향상
```
기존: 각 단계가 독립적으로 실행
개선: 전체 대화 맥락에서 자연스러운 연결
```

## 3. 전환 방법 🔄

### Phase 1: 코어 모듈 교체
1. `PlanningExecutor` → `NaturalPlanningExecutor`
2. `ExecutionPlan` 모델 제거
3. `PlanStep` 구조 제거

### Phase 2: 인터페이스 통합
1. Discord Bot에서 자연어 실행기 사용
2. CLI에서 자연어 실행기 사용  
3. MCP 도구와 자연어 연결 강화

### Phase 3: 검증 시스템 강화
1. 실제 작업 수행 여부 자연어 검증
2. 성공/실패 판단 LLM 기반으로 전환
3. 사용자 만족도 자연어 피드백

## 4. 구현 우선순위 📝

### 🚀 즉시 적용 가능
- [x] 자연어 실행기 구현 완료
- [x] JSON 직렬화 오류 해결
- [x] 기본 테스트 통과

### ⚡ 단기 목표 (1-2일)
- [ ] 기존 시스템과 통합
- [ ] MCP 도구 연결 강화 
- [ ] Discord Bot 연결

### 🎯 중기 목표 (1주)
- [ ] 완전한 자연어 기반 전환
- [ ] 성능 최적화
- [ ] 사용자 경험 향상

## 5. 기술적 혜택 💡

### A. 개발 생산성
- Pydantic 스키마 정의 불필요
- JSON 직렬화/역직렬화 오류 제거
- 스키마 변경에 따른 호환성 문제 해결

### B. 시스템 유연성
- 새로운 도구 추가 시 스키마 수정 불필요
- 자연어로 도구 사용법 설명만 추가
- LLM이 자동으로 사용법 학습

### C. 에러 처리
- 구조화된 에러 대신 자연어 설명
- 사용자가 이해하기 쉬운 오류 메시지
- 문제 해결 방안 자동 제안

## 6. 사용자 경험 개선 👥

### A. 더 자연스러운 대화
```
기존: "작업 ID 123의 단계 2가 실패했습니다"
개선: "파일을 찾을 수 없어서 다른 방법으로 시도해보겠습니다"
```

### B. 실시간 진행 상황 공유
```
기존: 단계별 상태 업데이트
개선: "지금 파일을 확인 중입니다... 파일이 있네요!"
```

### C. 상황 적응 능력
```
기존: 계획 변경 시 전체 재시작
개선: "아, 그렇다면 이 방법은 어떨까요?"
```

## 7. 결론 🎯

사용자의 통찰이 정확했습니다:

> "어차피 다시 LLM에게 들어갈 것이라면 굳이 JSON 강제할 필요 없다"

이 접근법으로:
1. ✅ JSON 직렬화 오류 완전 해결
2. ✅ 에이전틱 AI 원칙 완벽 준수  
3. ✅ 자연스러운 사용자 경험
4. ✅ 개발 복잡성 대폭 감소

**다음 단계: 기존 시스템을 자연어 기반으로 완전 전환하시겠습니까?**
